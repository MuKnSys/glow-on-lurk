{"Evaluation":{"expr":"(LETREC ((ACTION (LAMBDA (I PID A) (CONS (QUOTE ACTION) (CONS I (CONS PID (CONS A NIL)))))) (WITHDRAW (LAMBDA (N) (CONS (QUOTE WITHDRAW) (CONS N NIL)))) (DEPOSIT (LAMBDA (N) (CONS (QUOTE DEPOSIT) (CONS N NIL)))) (PUBLISH (LAMBDA (I PID) (CONS (QUOTE PUBLISH) (CONS I (CONS PID NIL))))) (REQUIRE (LAMBDA (V) (CONS (QUOTE REQUIRE) (CONS V NIL)))) (MK-PURE (LAMBDA (A) (CONS (QUOTE PURE) (CONS A NIL)))) (MK-BIND (LAMBDA (A B) (CONS (QUOTE BIND) (CONS A (CONS B NIL))))) (MK-NEXT (LAMBDA (A B) (CONS (QUOTE NEXT) (CONS A (CONS B NIL))))) (PURE MK-PURE) (BIND MK-BIND) (NEXT MK-NEXT) (DIGESTPRIM (LAMBDA (A) (CONS (QUOTE DIGEST) (CONS A NIL)))) (EQPRIM (LAMBDA (A B) (EQ A B))) (DIGESTNAT DIGESTPRIM) (==DIGEST EQPRIM) (==NAT EQPRIM) (SUCNAT (LAMBDA (X) (IF (EQ X NIL) (QUOTE (T)) (IF (CAR X) (CONS NIL (SUCNAT (CDR X))) (CONS T (CDR X)))))) (+NNATH (LAMBDA (A B CARRY) (IF (EQ A NIL) (IF CARRY (SUCNAT B) B) (IF (EQ B NIL) (IF CARRY (SUCNAT A) A) (IF (CAR A) (IF (CAR B) (CONS CARRY (+NNATH (CDR A) (CDR B) T)) (CONS (IF CARRY NIL T) (+NNATH (CDR A) (CDR B) CARRY))) (IF (CAR B) (CONS (IF CARRY NIL T) (+NNATH (CDR A) (CDR B) CARRY)) (CONS CARRY (+NNATH (CDR A) (CDR B) NIL)))))))) (+NAT (LAMBDA (A B) (+NNATH A B NIL))) (*NAT (LAMBDA (A B) (IF A (+NAT (IF (CAR A) B NIL) (CONS NIL (*NAT (CDR A) B))) NIL))) (PFARROWNAT (LAMBDA (A) (IF (EQ 0 A) NIL (SUCNAT (PFARROWNAT (- A 1)))))) (NATARROWPF (LAMBDA (A) (IF A (+ (IF (CAR A) 1 0) (* 2 (NATARROWPF (CDR A)))) 0))) (BITWISE-XOR (LAMBDA (A B) (IF (EQ A NIL) B (IF (EQ B NIL) A (LET ((HD (IF (CAR A) (IF (CAR B) NIL T) B)) (TAIL (BITWISE-XOR (CDR A) (CDR B)))) (IF TAIL (CONS HD TAIL) HD)))))) (BITWISE-AND (LAMBDA (A B) (IF (EQ A NIL) NIL (IF (EQ B NIL) NIL (LET ((HD (IF (CAR A) (CAR B) NIL)) (TAIL (BITWISE-AND (CDR A) (CDR B)))) (IF TAIL (CONS HD TAIL) HD)))))) (ATOMIC-ACTION-REC (LAMBDA (CODE CASE-BIND CASE-NEXT CASE-PURE CASE-REQUIRE CASE-ATOM) (IF (EQ (CAR CODE) (QUOTE BIND)) (CASE-BIND (CAR (CDR CODE)) (CAR (CDR (CDR CODE)))) (IF (EQ (CAR CODE) (QUOTE NEXT)) (CASE-NEXT (CAR (CDR CODE)) (CAR (CDR (CDR CODE)))) (IF (EQ (CAR CODE) (QUOTE PURE)) (CASE-PURE (CAR (CDR CODE))) (IF (EQ (CAR CODE) (QUOTE REQUIRE)) (CASE-REQUIRE (CAR (CDR CODE))) (CASE-ATOM CODE (CAR (CDR CODE)) (CAR CODE)))))))) (GLOW-CODE (LAMBDA (WAGERAMOUNT ESCROWAMOUNT) (BIND (PUBLISH 1 0) (LAMBDA (COMMITMENT) (BIND (PURE (+NAT WAGERAMOUNT ESCROWAMOUNT)) (LAMBDA (TMP) (NEXT (ACTION 2 0 (DEPOSIT TMP)) (BIND (PUBLISH 3 1) (LAMBDA (RANDB) (NEXT (ACTION 4 1 (DEPOSIT WAGERAMOUNT)) (BIND (PUBLISH 5 0) (LAMBDA (RANDA) (BIND (PURE (DIGESTPRIM RANDA)) (LAMBDA (TMP0) (BIND (PURE (EQ COMMITMENT TMP0)) (LAMBDA (TMP1) (BIND (PURE (BITWISE-XOR RANDA RANDB)) (LAMBDA (TMP2) (BIND (PURE (BITWISE-AND TMP2 (QUOTE (T)))) (LAMBDA (TMP3) (BIND (PURE (EQ TMP3 NIL)) (LAMBDA (TMP4) (IF TMP4 (BIND (PURE (*NAT (QUOTE (NIL T)) WAGERAMOUNT)) (LAMBDA (TMP5) (BIND (PURE (+NAT TMP5 ESCROWAMOUNT)) (LAMBDA (TMP6) (NEXT (ACTION 6 0 (WITHDRAW TMP6)) (PURE (QUOTE GLOW-UNIT-LIT))))))) (BIND (PURE (*NAT (QUOTE (NIL T)) WAGERAMOUNT)) (LAMBDA (TMP7) (NEXT (ACTION 7 1 (WITHDRAW TMP7)) (NEXT (ACTION 8 0 (WITHDRAW ESCROWAMOUNT)) (PURE (QUOTE GLOW-UNIT-LIT))))))))))))))))))))))))))))) (RUN-GLOW (LAMBDA (PUBS CODE START TARGET) (ATOMIC-ACTION-REC CODE (LAMBDA (CODE-A FUN-B) (LET ((RESULT-A (RUN-GLOW PUBS CODE-A START TARGET))) (IF (ATOM RESULT-A) RESULT-A (LET ((PUBS2 (CAR (CAR RESULT-A))) (CODE2 (FUN-B (CAR (CDR RESULT-A)))) (START2 (CAR (CDR (CAR RESULT-A))))) (RUN-GLOW PUBS2 CODE2 START2 TARGET))))) (LAMBDA (CODE-A CODE-B) (LET ((RESULT-A (RUN-GLOW PUBS CODE-A START TARGET))) (IF (ATOM RESULT-A) RESULT-A (LET ((PUBS2 (CAR (CAR RESULT-A))) (START2 (CAR (CDR (CAR RESULT-A))))) (RUN-GLOW PUBS2 CODE-B START2 TARGET))))) (LAMBDA (X) (CONS (CONS PUBS (CONS START NIL)) (CONS X NIL))) (LAMBDA (X) (IF X (CONS (CONS PUBS (CONS START NIL)) (CONS X NIL)) (QUOTE REQUIRE-FAIL))) (LAMBDA (A ID H) (IF START (LET ((NEW-START (IF (EQ START ID) NIL START)) (NEW-PUBS (IF (EQ H (QUOTE PUBLISH)) (CDR PUBS) PUBS)) (RESULT (IF (EQ H (QUOTE PUBLISH)) (CAR PUBS) (QUOTE GLOW-UNIT-LIT)))) (CONS (CONS NEW-PUBS (CONS NEW-START NIL)) (CONS RESULT NIL))) (EQ A TARGET))))))) (RUN-GLOW (QUOTE NIL) (GLOW-CODE (QUOTE (NIL T NIL T)) (QUOTE (NIL T NIL T))) NIL (QUOTE (PUBLISH 1 0))))","env":"NIL","cont":"Outermost","expr_out":"T","env_out":"NIL","cont_out":"Terminal","status":"Terminal","iterations":457}}